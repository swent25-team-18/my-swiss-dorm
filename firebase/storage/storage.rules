rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    function isAccessAllowed() {
        return firestore.exists(/databases/(default)/documents/config/allowTestClear);
    }

    match /photos/{photo} {
        allow read: if request.auth != null || isAccessAllowed();
        allow write: if request.auth != null || isAccessAllowed();
    }
    match /{allPaths=**} {
      allow read, write: if isAccessAllowed();
    }
  }
}